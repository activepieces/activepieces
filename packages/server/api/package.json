{
  "name": "server-api",
  "version": "0.0.1",
  "private": true,
  "type": "commonjs",
  "scripts": {
    "build": "tsc -p tsconfig.app.json --noEmit",
    "serve": "cd ../../.. && tsx --env-file=packages/server/api/.env --tsconfig packages/server/api/tsconfig.app.json packages/server/api/src/main.ts",
    "lint": "eslint 'src/**/*.ts'",
    "test": "npm run test-ce && npm run test-ee && npm run test-cloud",
    "test-unit": "jest --config jest.config.ts --testPathPattern 'test/unit' --bail --passWithNoTests=false",
    "test-ce-command": "jest --config jest.config.ts --testPathPattern 'test/integration/ce' --bail --passWithNoTests=false",
    "test-ee-command": "jest --config jest.config.ts --testPathPattern 'test/integration/ee' --bail --passWithNoTests=false",
    "test-cloud-command": "jest --config jest.config.ts --testPathPattern 'test/integration/cloud' --bail --passWithNoTests=false",
    "test-ce": "export $(cat .env.tests | xargs) && NODE_OPTIONS='--experimental-vm-modules' AP_EDITION=ce npm run test-ce-command",
    "test-ee": "export $(cat .env.tests | xargs) && NODE_OPTIONS='--experimental-vm-modules' AP_EDITION=ee npm run test-ee-command",
    "test-cloud": "export $(cat .env.tests | xargs) && NODE_OPTIONS='--experimental-vm-modules' AP_EDITION=cloud npm run test-cloud-command",
    "check-migrations": "echo 'üîç Checking for schema changes...' && export $(cat .env.tests | xargs) && export AP_DEV_PIECES='' && export AP_ENVIRONMENT=dev && AP_EDITION=ce && ts-node -r tsconfig-paths/register -P tsconfig.app.json ./node_modules/typeorm/cli.js migration:run -d src/app/database/migration-data-source.ts > /dev/null 2>&1 && echo 'Checking for schema drift...' && ts-node -r tsconfig-paths/register -P tsconfig.app.json ./node_modules/typeorm/cli.js migration:generate -p -d src/app/database/migration-data-source.ts src/app/database/migration/postgres/check --dryrun --check || (echo '‚ùå ERROR: Schema changes detected without migration!' && exit 1) && echo '‚úÖ No missing migrations detected'",
    "db": "ts-node -r tsconfig-paths/register -P tsconfig.app.json ./node_modules/typeorm/cli.js",
    "test:docker": "UID=\"$(id -u)\" GID=\"$(id -g)\" docker compose --profile full -f docker-compose.test.yml up --exit-code-from app --attach app"
  }
}
